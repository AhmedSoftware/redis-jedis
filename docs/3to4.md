## Breaking Changes from Jedis 3 to Jedis 4 and Hints to Migrate

- Jedis and JedisPool constructors with a String parameter without any int parameter will only support a URL or URI string.
  - Jedis(String)
  - JedisPool(String)
  - JedisPool(String, SSLSocketFactory, SSLParameters, HostnameVerifier)
  - JedisPool(GenericObjectPoolConfig<Jedis>, String)

- In xrange or xrevrange methods with StreamEntryID as parameters,
  sending `null` for both start and end parameters would raise conflict.

  Casting the `null`s to StreamEntryID (`(StreamEntryID) null`) would resolve the issue.

- Many SortedSet methods will return Java `List` instead of `Set`. [Listed here](3to4-zset-list.md)

- Many methods now returns primitive values (`long`/`boolean`/`double` instead of `Long`/`Boolean`/`Double`). [Listed here](3to4-primitives.md)

- BinaryJedis and BinaryJedisCluster classes are removed.

  Methods of these classes are available in Jedis and JedisCluster classes respectively.

- Client and BinaryClient classes are removed.

- Commands interfaces are restructured. In other words, `redis.clients.jedis.commands` package is reimplemented.

- Return type of Jedis.shutdown() is now `void`.<br>
  Previously, in ideal scenario, it would always return null.

- ShardedJedisPool, Sharded, ShardedJedis, BinaryShardedJedis, ShardInfo, JedisShardInfo classes are removed.
  - Introduced JedisSharding class.

      Earlier codes without the use of "name" and "weight" (in ShardInfo/JedisShardInfo) are easily transferable new class.

- ShardedJedisPipeline class is removed.
  - Introduced ShardedPipeline class.

- The type of Protocol.CHARSET is changed to `java.nio.charset.Charset`.

- JedisCluster constructors with `GenericObjectPoolConfig<Jedis>` now accept `GenericObjectPoolConfig<Connection>`.

- JedisCluster.getClusterNodes() now returns `Map<String, ConnectionPool>` instead of `Map<String, JedisPool>`.

- JedisCluster.getConnectionFromSlot(int) now returns `Connection` instead of `Jedis`.

- JedisClusterHostAndPortMap interface is removed. Use HostAndPortMapper interface.

- Some classes are moved into `redis.clients.jedis.args` package.
  - BitOP
  - GeoUnit
  - ListPosition

- Some classes are moved into `redis.clients.jedis.params` package.
  - BitPosParams
  - ScanParams
  - SortingParams
  - ZParams

- Some classes are moved into `redis.clients.jedis.resps` package.
  - AccessControlLogEntry
  - AccessControlUser
  - GeoRadiusResponse
  - ScanResult
  - Slowlog
  - StreamConsumersInfo
  - StreamEntry
  - StreamGroupInfo
  - StreamInfo
  - StreamPendingEntry
  - StreamPendingSummary
  - Tuple

- Some BuilderFactory implementations are removed.
  - OBJECT (use RAW_OBJECT)
  - BYTE_ARRAY_ZSET (use BINARY_LIST or BINARY_SET)
  - BYTE_ARRAY_MAP (use BINARY_MAP)
  - STRING_ZSET (use STRING_LIST or STRING_SET)
  - EVAL_RESULT (use ENCODED_OBJECT)
  - EVAL_BINARY_RESULT (use RAW_OBJECT)

- ...
  - ClusterReset is removed. Use ClusterResetType.
  - DebugParams is removed.
  - JedisExhaustedPoolException is removed. JedisException with same/similar message would be thrown instead of it.
  - JedisClusterMaxAttemptsException is removed. JedisClusterOperationException with same/similar message would be thrown instead of it.
  - JedisNoReachableClusterNodeException is removed. JedisClusterOperationException with same/similar message would be thrown instead of it.

- HostAndPort class
  - Removed variables
    - `localhost`

  - Removed methods
    - extractParts
    - parseString
    - convertHost
    - setLocalhost
    - getLocalhost
    - getLocalHostQuietly

- Protocol class
  - All String variables representing to Sentinel, Cluster and PubSub sub-commands are removed.

- Sentinel methods are removed from Jedis class and put in new Sentinel class.

- Transaction inside Pipeline is removed. E.g. multi(), exec() and discard() methods are removed from Pipeline.

- execGetResponse() method is removed from Transaction.

- JedisClusterHashTagUtil class is renamed to JedisClusterHashTag.

- KeyMergeUtil class is removed.

- Jedis.aclLog(String) and Jedis.aclLog(byte[]) methods are removed.<br>
  Jedis.aclLogReset() method is added to serve the purpose.

- Jedis.debug(DebugParams) method is removed.

- Jedis.sync() method is removed.

- Jedis.configSetBinary(byte[], byte[]) method. Use Jedis.configSet(byte[], byte[]).

- Jedis.pubsubNumSub(String...) method now returns `Map<String, Long>` instead of `Map<String, String>`.

- Jedis.scriptExists(byte[]) now returns `Boolean` instead of `Long`.

- Jedis.scriptExists(byte[]...) now returns `List<Boolean>` instead of `List<Long>`.

- `watch` and `unwatch` methods of Transaction class is not supported within MULTI (after multi() method). It can be used before MULTI.

- Following cases would throw IllegalStateException instead of JedisDataException.
  - `Cannot use Jedis when in Multi. Please use Transaction or reset jedis state.`
  - `Cannot use Jedis when in Pipeline. Please use Pipeline or reset jedis state.`

- `eval` and `evalsha` methods are now considered non-blocking. These were considered blocking till Jedis 3.x.

- Queable.getResponse(Builder<T> builder) method is renamed to Queable.enqueResponse(Builder<T> builder).

- All methods in Queable are now `final`. Listed as follows:
  - clean()
  - generateResponse(Object data)
  - enqueResponse(Builder<T> builder)
  - getPipelinedResponseLength()
